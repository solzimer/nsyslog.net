<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ejemplo 2: Lectura y parseo de fichero CSV | nsyslog</title>
    <meta name="description" content="The next gen log agent">
    
    
    <link rel="preload" href="/assets/css/0.styles.79931b71.css" as="style"><link rel="preload" href="/assets/js/app.e497b60b.js" as="script"><link rel="preload" href="/assets/js/2.d8bd88d5.js" as="script"><link rel="preload" href="/assets/js/87.ee8b94f6.js" as="script"><link rel="prefetch" href="/assets/js/10.25be7a11.js"><link rel="prefetch" href="/assets/js/100.1fd11945.js"><link rel="prefetch" href="/assets/js/101.bd0254f2.js"><link rel="prefetch" href="/assets/js/102.160dedfe.js"><link rel="prefetch" href="/assets/js/103.a43c212b.js"><link rel="prefetch" href="/assets/js/104.72a470ac.js"><link rel="prefetch" href="/assets/js/105.552a58d1.js"><link rel="prefetch" href="/assets/js/106.704e1d77.js"><link rel="prefetch" href="/assets/js/107.d2ee6071.js"><link rel="prefetch" href="/assets/js/108.d423a06e.js"><link rel="prefetch" href="/assets/js/109.7ab54c94.js"><link rel="prefetch" href="/assets/js/11.67557d65.js"><link rel="prefetch" href="/assets/js/110.1b128357.js"><link rel="prefetch" href="/assets/js/111.7742d7ca.js"><link rel="prefetch" href="/assets/js/112.794ea947.js"><link rel="prefetch" href="/assets/js/113.d60b2e70.js"><link rel="prefetch" href="/assets/js/114.fa889948.js"><link rel="prefetch" href="/assets/js/115.2f3609a0.js"><link rel="prefetch" href="/assets/js/116.2382ccde.js"><link rel="prefetch" href="/assets/js/117.0a39c803.js"><link rel="prefetch" href="/assets/js/118.18aff04a.js"><link rel="prefetch" href="/assets/js/119.105d2cb1.js"><link rel="prefetch" href="/assets/js/12.c9f8299f.js"><link rel="prefetch" href="/assets/js/120.d1e5c01a.js"><link rel="prefetch" href="/assets/js/121.061fa520.js"><link rel="prefetch" href="/assets/js/13.4458b283.js"><link rel="prefetch" href="/assets/js/14.3236e528.js"><link rel="prefetch" href="/assets/js/15.6c9fcf56.js"><link rel="prefetch" href="/assets/js/16.7ac77464.js"><link rel="prefetch" href="/assets/js/17.11771f33.js"><link rel="prefetch" href="/assets/js/18.1d6a5d99.js"><link rel="prefetch" href="/assets/js/19.5f3b3bf7.js"><link rel="prefetch" href="/assets/js/20.038a2dfd.js"><link rel="prefetch" href="/assets/js/21.a07e47c5.js"><link rel="prefetch" href="/assets/js/22.1ad069e0.js"><link rel="prefetch" href="/assets/js/23.b4d1f27e.js"><link rel="prefetch" href="/assets/js/24.cb5726e6.js"><link rel="prefetch" href="/assets/js/25.000ef583.js"><link rel="prefetch" href="/assets/js/26.16c500a4.js"><link rel="prefetch" href="/assets/js/27.4332b535.js"><link rel="prefetch" href="/assets/js/28.0c040c7b.js"><link rel="prefetch" href="/assets/js/29.b8fd9d3d.js"><link rel="prefetch" href="/assets/js/3.6ff0db38.js"><link rel="prefetch" href="/assets/js/30.1b395c0e.js"><link rel="prefetch" href="/assets/js/31.b2fb8f98.js"><link rel="prefetch" href="/assets/js/32.d34398c2.js"><link rel="prefetch" href="/assets/js/33.09b9a05b.js"><link rel="prefetch" href="/assets/js/34.877c8f3f.js"><link rel="prefetch" href="/assets/js/35.2319ab57.js"><link rel="prefetch" href="/assets/js/36.46826e1b.js"><link rel="prefetch" href="/assets/js/37.52c2f365.js"><link rel="prefetch" href="/assets/js/38.a125878b.js"><link rel="prefetch" href="/assets/js/39.5699d0eb.js"><link rel="prefetch" href="/assets/js/4.3776f917.js"><link rel="prefetch" href="/assets/js/40.96565717.js"><link rel="prefetch" href="/assets/js/41.87e5ff6a.js"><link rel="prefetch" href="/assets/js/42.8eb25147.js"><link rel="prefetch" href="/assets/js/43.3682bf33.js"><link rel="prefetch" href="/assets/js/44.4274b921.js"><link rel="prefetch" href="/assets/js/45.b89bf82d.js"><link rel="prefetch" href="/assets/js/46.2be48b0a.js"><link rel="prefetch" href="/assets/js/47.7d3f6e29.js"><link rel="prefetch" href="/assets/js/48.723c2aea.js"><link rel="prefetch" href="/assets/js/49.90952974.js"><link rel="prefetch" href="/assets/js/5.201f9484.js"><link rel="prefetch" href="/assets/js/50.b12880ff.js"><link rel="prefetch" href="/assets/js/51.2e8cdf1b.js"><link rel="prefetch" href="/assets/js/52.fe6dab50.js"><link rel="prefetch" href="/assets/js/53.1fc7be6b.js"><link rel="prefetch" href="/assets/js/54.af6a4a03.js"><link rel="prefetch" href="/assets/js/55.ef513e19.js"><link rel="prefetch" href="/assets/js/56.ae7be80c.js"><link rel="prefetch" href="/assets/js/57.56fbc8f1.js"><link rel="prefetch" href="/assets/js/58.4a383a96.js"><link rel="prefetch" href="/assets/js/59.26479323.js"><link rel="prefetch" href="/assets/js/6.ce391908.js"><link rel="prefetch" href="/assets/js/60.56b8e80c.js"><link rel="prefetch" href="/assets/js/61.da8a70b7.js"><link rel="prefetch" href="/assets/js/62.d43d9ce8.js"><link rel="prefetch" href="/assets/js/63.c7ada83a.js"><link rel="prefetch" href="/assets/js/64.89d4e92c.js"><link rel="prefetch" href="/assets/js/65.ab963038.js"><link rel="prefetch" href="/assets/js/66.b8a11416.js"><link rel="prefetch" href="/assets/js/67.79a17332.js"><link rel="prefetch" href="/assets/js/68.1cf9a12b.js"><link rel="prefetch" href="/assets/js/69.8773efdc.js"><link rel="prefetch" href="/assets/js/7.71f1338d.js"><link rel="prefetch" href="/assets/js/70.c800b687.js"><link rel="prefetch" href="/assets/js/71.289f6850.js"><link rel="prefetch" href="/assets/js/72.6c4dc4a1.js"><link rel="prefetch" href="/assets/js/73.9515f00c.js"><link rel="prefetch" href="/assets/js/74.6a2b7ff8.js"><link rel="prefetch" href="/assets/js/75.8638dc37.js"><link rel="prefetch" href="/assets/js/76.db9a5250.js"><link rel="prefetch" href="/assets/js/77.d5ac182b.js"><link rel="prefetch" href="/assets/js/78.4ecc0819.js"><link rel="prefetch" href="/assets/js/79.8d9e146d.js"><link rel="prefetch" href="/assets/js/8.4938feae.js"><link rel="prefetch" href="/assets/js/80.3de8f9cf.js"><link rel="prefetch" href="/assets/js/81.c41d9ec9.js"><link rel="prefetch" href="/assets/js/82.36eb15cc.js"><link rel="prefetch" href="/assets/js/83.7fe510af.js"><link rel="prefetch" href="/assets/js/84.d52ec84e.js"><link rel="prefetch" href="/assets/js/85.42676dd5.js"><link rel="prefetch" href="/assets/js/86.2be597ee.js"><link rel="prefetch" href="/assets/js/88.37efe603.js"><link rel="prefetch" href="/assets/js/89.20dbc4ef.js"><link rel="prefetch" href="/assets/js/9.266c7a40.js"><link rel="prefetch" href="/assets/js/90.c16ccb38.js"><link rel="prefetch" href="/assets/js/91.9f225352.js"><link rel="prefetch" href="/assets/js/92.18241469.js"><link rel="prefetch" href="/assets/js/93.6f8df5a5.js"><link rel="prefetch" href="/assets/js/94.f4610960.js"><link rel="prefetch" href="/assets/js/95.4f092a2c.js"><link rel="prefetch" href="/assets/js/96.47303597.js"><link rel="prefetch" href="/assets/js/97.dd78b59a.js"><link rel="prefetch" href="/assets/js/98.589603ed.js"><link rel="prefetch" href="/assets/js/99.f1b81aa0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.79931b71.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">nsyslog</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/intro/install.html" class="nav-link">Start</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/intro/basics.html" class="nav-link">Introduction</a></li><li class="dropdown-item"><!----> <a href="/config/basic.html" class="nav-link">Configuration</a></li></ul></div></div><div class="nav-item"><a href="/jsdoc/index.html" class="nav-link">API docs</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/intro/example2.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/es/intro/example2.html" class="nav-link">Espa√±ol</a></li></ul></div></div> <!----></nav> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/intro/install.html" class="nav-link">Start</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/intro/basics.html" class="nav-link">Introduction</a></li><li class="dropdown-item"><!----> <a href="/config/basic.html" class="nav-link">Configuration</a></li></ul></div></div><div class="nav-item"><a href="/jsdoc/index.html" class="nav-link">API docs</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/intro/example2.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/es/intro/example2.html" class="nav-link">Espa√±ol</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/intro/install.html" class="sidebar-link">Installation</a></li><li><a href="/intro/basics.html" class="sidebar-link">Basics</a></li><li><a href="/intro/example1.html" class="sidebar-link">Ejemplo 1: Servidor de syslog</a></li><li><a href="/intro/example2.html" class="active sidebar-link">Ejemplo 2: Lectura y parseo de fichero CSV</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/intro/example2.html#logagent-json" class="sidebar-link">logagent.json</a></li><li class="sidebar-sub-header"><a href="/intro/example2.html#ejecucion" class="sidebar-link">Ejecuci√≥n</a></li></ul></li><li><a href="/intro/commands.html" class="sidebar-link">L√≠nea de comandos</a></li><li><a href="/intro/cli.html" class="sidebar-link">Modo CLI</a></li><li><a href="/intro/expressions.html" class="sidebar-link">Expresiones</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ejemplo-2-lectura-y-parseo-de-fichero-csv"><a href="#ejemplo-2-lectura-y-parseo-de-fichero-csv" aria-hidden="true" class="header-anchor">#</a> Ejemplo 2: Lectura y parseo de fichero CSV</h1> <p>El siguiente ejemplo consiste en leer un fichero en formato CSV, parsear su contenido, y almacenarlo en una colecci√≥n de MongoDB:</p> <h2 id="logagent-json"><a href="#logagent-json" aria-hidden="true" class="header-anchor">#</a> logagent.json</h2> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;inputs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;csv_file&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;examples/config/data/csv002.csv&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;mode&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;watermark&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;offset&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;start&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token property">&quot;processors&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;parser&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;csvparser&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;input&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${originalMessage}&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;output&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;fields&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;options&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;delimiter&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;, &quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;columns&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token property">&quot;transporters&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;db_store&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongo&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost/nsyslog&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;collection&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;csvdata&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;format&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${fields}&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token property">&quot;flows&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span><span class="token property">&quot;from&quot;</span><span class="token operator">:</span><span class="token string">&quot;csv_file&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;processors&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;parser&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token property">&quot;transporters&quot;</span><span class="token operator">:</span><span class="token string">&quot;db_store&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="fuentes"><a href="#fuentes" aria-hidden="true" class="header-anchor">#</a> Fuentes</h3> <p>Se define una fuente de entrada en el apartado <strong>inputs</strong> :</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;inputs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;csv_file&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;path&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;examples/config/data/csv002.csv&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;mode&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;watermark&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;offset&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;start&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Esta fuente, de tipo <a href="/inputs/file.html">file</a>, leer√° un fichero CSV, l√≠nea a l√≠nea. Aunque en el enlace anterior se puede ver con m√°s detalle el funcionamiento de las fuentes tipo <em>file</em>, veamos cual va a ser su comportamiento en este caso:</p> <ul><li><strong>path</strong>: S√≥lo queremos leer un determinado fichero, as√≠ que establecemos su ruta.</li> <li><strong>mode</strong>: Usamos el modo <em>watermark</em>; esto significa que la fuente ir√° almacenando en disco la posici√≥n de lectura, de forma que si reiniciamos nsyslog, la fuente recordar√° la posici√≥n previa y seguir√° leyendo el fichero en el mismo punto donde se qued√≥.</li> <li><strong>offset</strong>: Desde d√≥nde se empieza a leer un nuevo fichero. En este caso, desde el principio.</li></ul> <h3 id="procesadores"><a href="#procesadores" aria-hidden="true" class="header-anchor">#</a> Procesadores</h3> <p>A continuaci√≥n se crea un procesador:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;processors&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;parser&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;csvparser&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;input&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${originalMessage}&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;output&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;fields&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;options&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">&quot;delimiter&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;, &quot;</span><span class="token punctuation">,</span>
					<span class="token property">&quot;columns&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Este procesador, <strong>parser</strong>, de tipo <a href="/processors/csvparser.html">csvparser</a>, ser√° el encargado de parsear l√≠neas en formato CSV y transformarlas a objetos JSON. Su configuraci√≥n es:</p> <ul><li><strong>input</strong>: Aqu√≠ se usa una <a href="/intro/expressions.html">expresi√≥n</a> para indicar que la l√≠nea est√° contenida en el campo <em>originalMessage</em> del dato de entrada.</li> <li><strong>output</strong>: El campo donde almacenar el resultado del parseo.</li> <li><strong>delimiter</strong>: Las columnas de una fila CSV est√°n separadas por coma.</li> <li><strong>columns</strong>: Queremos que el resultado no sea un simple array de valores, sino un objeto completo cuyos atributos coincidan con los nombres de los campos de cada columna. Para ello, el parser usar√° la primera fila del fichero CSV para obtener los nombres de las columnas.</li></ul> <h3 id="transportes"><a href="#transportes" aria-hidden="true" class="header-anchor">#</a> Transportes</h3> <p>Se configura un transporte a MongoDB:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;transporters&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;db_store&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongo&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;url&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mongodb://localhost/nsyslog&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;collection&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;csvdata&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;format&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${fields}&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Dicho transporte <strong>db_store</strong>, de tipo <a href="/transporters/mongo.html">mongo</a>, escribir√° el campo <em>fields</em> (donde est√°n almacenados los valores de cada fila CSV) en una colecci√≥n de MongoDB (csvdata).</p> <h3 id="flujo"><a href="#flujo" aria-hidden="true" class="header-anchor">#</a> Flujo</h3> <p>Por √∫ltimo, al igual que en el <a href="/intro/example1.html">Ejemplo 1</a>, se define el flujo:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;flows&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span><span class="token property">&quot;from&quot;</span><span class="token operator">:</span><span class="token string">&quot;csv_file&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;processors&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;parser&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token property">&quot;transporters&quot;</span><span class="token operator">:</span><span class="token string">&quot;db_store&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ejecucion"><a href="#ejecucion" aria-hidden="true" class="header-anchor">#</a> Ejecuci√≥n</h2> <p>Puedes descargar el fichero CSV de ejemplo: <a href="/assets/csv002.csv">csv002.csv</a></p> <p>A continuaci√≥n, ejecutamos nsyslog desde la l√≠nea de comandos:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>nsyslog -f logagent.json
</code></pre></div><p>Podemos comprobar como, en nuestra base de datos <strong>&quot;nsyslog&quot;</strong> de MongoDB, existe una colecci√≥n llamada <strong>&quot;csvdata&quot;</strong> que contiene datos tal que:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ mongo
<span class="token operator">&gt;</span> use nsyslog
switched to db nsyslog
<span class="token operator">&gt;</span> show collections
csvdata
<span class="token operator">&gt;</span> db.csvdata.findOne<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string">&quot;_id&quot;</span> <span class="token punctuation">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5d93cc3f77d1b8f3768e9e5d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token string">&quot;age&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;workclass&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Federal-gov&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;fnlwgt&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;249409&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;education&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;HS-grad&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;education-num&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;9&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;marital-status&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Never-married&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;occupation&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Other-service&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;relationship&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Own-child&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;race&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Black&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;sex&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;Male&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;capital-gain&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;capital-loss&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;hours-per-week&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;40&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;native-country&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;United-States&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;income&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;&lt;=50K&quot;</span>
<span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ‚Üê
        <a href="/intro/example1.html" class="prev">
          Ejemplo 1: Servidor de syslog
        </a></span> <span class="next"><a href="/intro/commands.html">
          L√≠nea de comandos
        </a>
        ‚Üí
      </span></p></div> </main></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e497b60b.js" defer></script><script src="/assets/js/2.d8bd88d5.js" defer></script><script src="/assets/js/87.ee8b94f6.js" defer></script>
  </body>
</html>

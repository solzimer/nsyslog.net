<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom components | nsyslog</title>
    <meta name="description" content="The next gen log agent">
    
    
    <link rel="preload" href="/assets/css/0.styles.d507ad78.css" as="style"><link rel="preload" href="/assets/js/app.891b13e7.js" as="script"><link rel="preload" href="/assets/js/2.9d00e57e.js" as="script"><link rel="preload" href="/assets/js/8.585cd2d0.js" as="script"><link rel="prefetch" href="/assets/js/10.5ec665e1.js"><link rel="prefetch" href="/assets/js/11.aa99dd27.js"><link rel="prefetch" href="/assets/js/12.604ceb44.js"><link rel="prefetch" href="/assets/js/13.a4ea9a0e.js"><link rel="prefetch" href="/assets/js/14.3fb49c36.js"><link rel="prefetch" href="/assets/js/15.fcf21d3a.js"><link rel="prefetch" href="/assets/js/16.0947b858.js"><link rel="prefetch" href="/assets/js/17.c9332f3c.js"><link rel="prefetch" href="/assets/js/18.edb0240a.js"><link rel="prefetch" href="/assets/js/19.5e3b5322.js"><link rel="prefetch" href="/assets/js/20.39f25410.js"><link rel="prefetch" href="/assets/js/21.afeb6b9c.js"><link rel="prefetch" href="/assets/js/22.d547ccf3.js"><link rel="prefetch" href="/assets/js/23.fd019117.js"><link rel="prefetch" href="/assets/js/24.1cf55ce1.js"><link rel="prefetch" href="/assets/js/25.fea664a1.js"><link rel="prefetch" href="/assets/js/26.a036aff3.js"><link rel="prefetch" href="/assets/js/27.05b03fbc.js"><link rel="prefetch" href="/assets/js/28.30cf147b.js"><link rel="prefetch" href="/assets/js/29.fe103202.js"><link rel="prefetch" href="/assets/js/3.1db7d10d.js"><link rel="prefetch" href="/assets/js/30.eeacdf5b.js"><link rel="prefetch" href="/assets/js/31.e04d19e4.js"><link rel="prefetch" href="/assets/js/32.accbc2cb.js"><link rel="prefetch" href="/assets/js/33.e7b3a4d3.js"><link rel="prefetch" href="/assets/js/34.31d6952e.js"><link rel="prefetch" href="/assets/js/35.44252b6d.js"><link rel="prefetch" href="/assets/js/36.3403fc4d.js"><link rel="prefetch" href="/assets/js/37.133e3d9e.js"><link rel="prefetch" href="/assets/js/38.674078c7.js"><link rel="prefetch" href="/assets/js/39.d17832db.js"><link rel="prefetch" href="/assets/js/4.4725fe9b.js"><link rel="prefetch" href="/assets/js/40.79c0af3a.js"><link rel="prefetch" href="/assets/js/41.2faa5cae.js"><link rel="prefetch" href="/assets/js/42.676f03e4.js"><link rel="prefetch" href="/assets/js/43.e6001f05.js"><link rel="prefetch" href="/assets/js/44.ce840aa8.js"><link rel="prefetch" href="/assets/js/45.e9bc769d.js"><link rel="prefetch" href="/assets/js/46.5c62db35.js"><link rel="prefetch" href="/assets/js/47.b1d1920b.js"><link rel="prefetch" href="/assets/js/48.26afa694.js"><link rel="prefetch" href="/assets/js/49.93c7ad5f.js"><link rel="prefetch" href="/assets/js/5.e0b424db.js"><link rel="prefetch" href="/assets/js/50.59078b51.js"><link rel="prefetch" href="/assets/js/51.8252ebff.js"><link rel="prefetch" href="/assets/js/52.6c822ae8.js"><link rel="prefetch" href="/assets/js/53.24a4f1d0.js"><link rel="prefetch" href="/assets/js/54.694b0907.js"><link rel="prefetch" href="/assets/js/55.52b284a0.js"><link rel="prefetch" href="/assets/js/56.3bc24bb4.js"><link rel="prefetch" href="/assets/js/57.0686d426.js"><link rel="prefetch" href="/assets/js/58.17400ca3.js"><link rel="prefetch" href="/assets/js/6.3273a52f.js"><link rel="prefetch" href="/assets/js/7.947a395e.js"><link rel="prefetch" href="/assets/js/9.cb9837a7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d507ad78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">nsyslog</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro/install.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/config/custom.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li><li class="dropdown-item"><!----> <a href="/es/" class="nav-link">es-ES</a></li></ul></div></div> <!----></nav> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro/install.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/config/custom.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li><li class="dropdown-item"><!----> <a href="/es/" class="nav-link">es-ES</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Custom components</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/config/custom.html#custom-components" class="sidebar-link">Custom components</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/config/custom.html#core-component" class="sidebar-link">Core component</a></li><li class="sidebar-sub-header"><a href="/config/custom.html#inputs" class="sidebar-link">Inputs</a></li><li class="sidebar-sub-header"><a href="/config/custom.html#processors" class="sidebar-link">Processors</a></li><li class="sidebar-sub-header"><a href="/config/custom.html#examples-2" class="sidebar-link">Examples</a></li><li class="sidebar-sub-header"><a href="/config/custom.html#transporters" class="sidebar-link">Transporters</a></li><li class="sidebar-sub-header"><a href="/config/custom.html#examples-3" class="sidebar-link">Examples</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="custom-components"><a href="#custom-components" aria-hidden="true" class="header-anchor">#</a> Custom components</h2> <p>NSyslog ships with a core set of inputs, processors and transporters, but you may need other components no present in this set. You may need, for example, an input from a propietary endpoint, derivate data using you own formulas, etc...</p> <p>That is why NSyslog allows registering and using custom components (inputs, processors and transporters). Implementing a NSyslog component is pretty easy. You only have to implement the interface of the core component, and code whatever needs to be done.</p> <h3 id="core-component"><a href="#core-component" aria-hidden="true" class="header-anchor">#</a> Core component</h3> <p>Inputs, processors and transporters are subclasses of <strong>Component</strong>. Let's take a look to the <strong>Component</strong> class:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmiter</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">configure</span><span class="token punctuation">(</span><span class="token parameter">cfg<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">pause</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">resume</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">stop</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">key</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//....</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>As you can see, the majority of the methods receive a <em>callback</em> function as their last argument. This allows for async method execution. When the method is done with its job, it must call the callback function following the NodeJS convention (error as first argument)</p> <p>Every compoment must implement the following methods:</p> <ul><li><strong>configure</strong> : It receives the component <em>config</em> object, declared in the configuration file. This will allow the component to be configured <strong>before</strong> it is started.</li> <li><strong>start</strong> : Starts the component. In case of push inputs, it will use the callback function to send the entries.</li> <li><strong>pause</strong> : Pauses the component</li> <li><strong>resume</strong> : Resumes a paused component</li> <li><strong>stop</strong> : Stop the component, releasing its resources.</li> <li><strong>key</strong> : This is a special method that will return a string that represents a summary of an entry. It's optional, and really meant to be used by input components.</li></ul> <h3 id="inputs"><a href="#inputs" aria-hidden="true" class="header-anchor">#</a> Inputs</h3> <p>As seen before, inputs can be <em>pull</em> or <em>push</em> inputs. This is its interface:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Input</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">get</span> <span class="token function">mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token constant">MODE</span><span class="token punctuation">.</span>push<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Input<span class="token punctuation">.</span><span class="token constant">MODE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
	push<span class="token punctuation">:</span><span class="token string">&quot;push&quot;</span><span class="token punctuation">,</span>
	pull<span class="token punctuation">:</span><span class="token string">&quot;pull&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Inputs have two additional methods:</p> <ul><li><strong>mode</strong> : Returns if the input is <em>push</em> or <em>pull</em></li> <li><strong>next</strong> : Used with <em>pull</em> inputs. Request a new entry.</li></ul> <h4 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples:</h4> <p>Push input:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Input <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nsyslog'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Input

<span class="token keyword">class</span> <span class="token class-name">MyPushInput</span> <span class="token keyword">extends</span> <span class="token class-name">Input</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>paused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>ival <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">configure</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>interval<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">100</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>threshold<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">get</span> <span class="token function">mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> Input<span class="token punctuation">.</span><span class="token constant">MODE</span><span class="token punctuation">.</span>push<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>ival <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>paused<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

			<span class="token keyword">let</span> rnd <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>rnd <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>threshold<span class="token punctuation">)</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">{</span>originalMessage <span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This is a push input: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rnd<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Threshold error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rnd<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">stop</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ival<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">pause</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>paused <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">resume</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>paused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">key</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mypush</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyPushInput<span class="token punctuation">;</span>
</code></pre></div><p>Pull input:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Input <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nsyslog'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Input

<span class="token keyword">class</span> <span class="token class-name">MyPullInput</span> <span class="token keyword">extends</span> <span class="token class-name">Input</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>paused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">configure</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>interval <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>interval<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">100</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>threshold<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">get</span> <span class="token function">mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> Input<span class="token punctuation">.</span><span class="token constant">MODE</span><span class="token punctuation">.</span>pull<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">next</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
			<span class="token keyword">let</span> rnd <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>rnd <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>threshold<span class="token punctuation">)</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">{</span>originalMessage <span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This is a pull input: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rnd<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Threshold error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>rnd<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">key</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">@mypush</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyPullInput<span class="token punctuation">;</span>
</code></pre></div><p>Configuration:</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;register&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;mypush&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;require&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom/mypushinput.js&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;mypull&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;require&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom/mypushinput.js&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>

	<span class="token property">&quot;inputs&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;pusher&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mypush&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;interval&quot;</span> <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
				<span class="token property">&quot;threshold&quot;</span> <span class="token operator">:</span> <span class="token number">0.3</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">&quot;puller&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mypull&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;interval&quot;</span> <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
				<span class="token property">&quot;threshold&quot;</span> <span class="token operator">:</span> <span class="token number">0.3</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="processors"><a href="#processors" aria-hidden="true" class="header-anchor">#</a> Processors</h3> <p>This is the Processor interface:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Processor</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">process</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>process</strong> : This is the key method of a processor. It receives an entry, and when its done, publish the results via the callback function.</li></ul> <p>Processors doesn't really need to publish an entry as a result of receiving one. You can call the <em>callback</em> function without arguments. In a similar way, a processor can output more than one result for an input entry.</p> <h3 id="examples-2"><a href="#examples-2" aria-hidden="true" class="header-anchor">#</a> Examples</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span>
	Processor <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nsyslog'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Processor<span class="token punctuation">,</span>
	jsexpr <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsexpr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyProcessor</span> <span class="token keyword">extends</span> <span class="token class-name">Processor</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>paused <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">configure</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>filter <span class="token operator">=</span> jsexpr<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>duplicate <span class="token operator">=</span> jsexpr<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>duplicate<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">process</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// Entry is filtered, so output nothing</span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">duplicate</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// Entry can produce more than one output</span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token punctuation">[</span>entry<span class="token punctuation">,</span>entry<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token comment">// Processors can be asynchronous</span>
			<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
				entry<span class="token punctuation">.</span>myProcess <span class="token operator">=</span> <span class="token string">'nothing done'</span><span class="token punctuation">;</span>
				<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyProcessor<span class="token punctuation">;</span>
</code></pre></div><p>Configuration:</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;register&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;processor&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;myproc&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;require&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom/custom-processor.js&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>

	<span class="token property">&quot;processors&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;multi&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;myproc&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;filter&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${originalMessage}.match(/[02468]$/)&quot;</span><span class="token punctuation">,</span>
				<span class="token property">&quot;duplicate&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${originalMessage}.match(/[13579]$/)&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Another way of creating custom processors is through the use of the <a href="/processors/multilang.html">multilang core processor</a></p> <h3 id="transporters"><a href="#transporters" aria-hidden="true" class="header-anchor">#</a> Transporters</h3> <p>This is the Transporter interface:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Transporter</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span>type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">transport</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>transport</strong> : This is the key method of a transporter. It receives an entry, and when its done, publish the results via the callback function.</li></ul> <h3 id="examples-3"><a href="#examples-3" aria-hidden="true" class="header-anchor">#</a> Examples</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span>
	Transporter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'nsyslog'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Core<span class="token punctuation">.</span>Transporter<span class="token punctuation">,</span>
	jsexpr <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsexpr'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyTransporter</span> <span class="token keyword">extends</span> <span class="token class-name">Transporter</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">configure</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span>callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		config <span class="token operator">=</span> config <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>format <span class="token operator">=</span> jsexpr<span class="token punctuation">.</span><span class="token function">expression</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>format<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">transport</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Output =&gt; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>entry<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> MyTransporter<span class="token punctuation">;</span>
</code></pre></div><p>Configuration:</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;register&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;transporter&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;mytrans&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;require&quot;</span><span class="token operator">:</span><span class="token string">&quot;custom/custom-transporter.js&quot;</span><span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">,</span>

	<span class="token property">&quot;transporters&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;console&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">&quot;type&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;mytrans&quot;</span><span class="token punctuation">,</span>
			<span class="token property">&quot;config&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">&quot;format&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;${seq}: ${originalMessage}&quot;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="/" class="router-link-active">Back</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.891b13e7.js" defer></script><script src="/assets/js/2.9d00e57e.js" defer></script><script src="/assets/js/8.585cd2d0.js" defer></script>
  </body>
</html>

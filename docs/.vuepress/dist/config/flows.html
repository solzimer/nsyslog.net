<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flows</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.7c693588.css" as="style"><link rel="preload" href="/assets/js/app.dc7d723d.js" as="script"><link rel="preload" href="/assets/js/2.ee805e80.js" as="script"><link rel="preload" href="/assets/js/10.82981d72.js" as="script"><link rel="prefetch" href="/assets/js/11.593d42e5.js"><link rel="prefetch" href="/assets/js/12.fbef4363.js"><link rel="prefetch" href="/assets/js/13.bcf91d61.js"><link rel="prefetch" href="/assets/js/14.40ddcaaf.js"><link rel="prefetch" href="/assets/js/15.e3a141ee.js"><link rel="prefetch" href="/assets/js/16.11640af6.js"><link rel="prefetch" href="/assets/js/17.4383e1e5.js"><link rel="prefetch" href="/assets/js/18.fd5c56a4.js"><link rel="prefetch" href="/assets/js/19.96975334.js"><link rel="prefetch" href="/assets/js/20.f4aab629.js"><link rel="prefetch" href="/assets/js/21.3c676196.js"><link rel="prefetch" href="/assets/js/22.73b2b516.js"><link rel="prefetch" href="/assets/js/23.2b92bb40.js"><link rel="prefetch" href="/assets/js/24.d3aeda6a.js"><link rel="prefetch" href="/assets/js/25.2f948326.js"><link rel="prefetch" href="/assets/js/26.81e02e86.js"><link rel="prefetch" href="/assets/js/27.f1506549.js"><link rel="prefetch" href="/assets/js/28.3cef5914.js"><link rel="prefetch" href="/assets/js/29.d5db1142.js"><link rel="prefetch" href="/assets/js/3.ae269ffb.js"><link rel="prefetch" href="/assets/js/30.bb38338e.js"><link rel="prefetch" href="/assets/js/31.1e69fb92.js"><link rel="prefetch" href="/assets/js/32.d10c032b.js"><link rel="prefetch" href="/assets/js/33.591ab542.js"><link rel="prefetch" href="/assets/js/34.632a3587.js"><link rel="prefetch" href="/assets/js/35.0ffd3dd1.js"><link rel="prefetch" href="/assets/js/36.7bc454ea.js"><link rel="prefetch" href="/assets/js/37.a97552b1.js"><link rel="prefetch" href="/assets/js/38.55002f7d.js"><link rel="prefetch" href="/assets/js/39.1681da09.js"><link rel="prefetch" href="/assets/js/4.1af835a2.js"><link rel="prefetch" href="/assets/js/40.f1de7e3f.js"><link rel="prefetch" href="/assets/js/41.79e94fa4.js"><link rel="prefetch" href="/assets/js/42.58ce4d1a.js"><link rel="prefetch" href="/assets/js/43.a60c6aa1.js"><link rel="prefetch" href="/assets/js/44.d9be02dd.js"><link rel="prefetch" href="/assets/js/45.7b787fc5.js"><link rel="prefetch" href="/assets/js/46.17c1ea4a.js"><link rel="prefetch" href="/assets/js/47.56acd73a.js"><link rel="prefetch" href="/assets/js/48.0fc08326.js"><link rel="prefetch" href="/assets/js/49.60e8d085.js"><link rel="prefetch" href="/assets/js/5.854cf577.js"><link rel="prefetch" href="/assets/js/50.6d2d56f2.js"><link rel="prefetch" href="/assets/js/51.65f40100.js"><link rel="prefetch" href="/assets/js/52.c9b7c531.js"><link rel="prefetch" href="/assets/js/53.82c0091a.js"><link rel="prefetch" href="/assets/js/54.1afb9dcc.js"><link rel="prefetch" href="/assets/js/55.82f3670d.js"><link rel="prefetch" href="/assets/js/56.6dae4490.js"><link rel="prefetch" href="/assets/js/6.7a8d578b.js"><link rel="prefetch" href="/assets/js/7.947a395e.js"><link rel="prefetch" href="/assets/js/8.eb2ec4f7.js"><link rel="prefetch" href="/assets/js/9.d5a52550.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7c693588.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro/install.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/intro/install.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/solzimer/nsyslog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Download
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flows</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/config/flows.html#flows" class="sidebar-link">Flows</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/config/flows.html#configuration" class="sidebar-link">Configuration</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/config/flows.html#nested-flows-flow-inheritance" class="sidebar-link">Nested flows (flow inheritance)</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="flows"><a href="#flows" aria-hidden="true" class="header-anchor">#</a> Flows</h2> <p>Flows are the way data is processed by NSyslog. It's the composition of inputs, filters, processors and transporters, in order to collect data from sourcesm transform it, and send it to its destinations.</p> <p>A flow tipically looks like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token string">&quot;flows&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			<span class="token comment">// ID is optional, but recomended</span>
			<span class="token string">&quot;id&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;myflow&quot;</span><span class="token punctuation">,</span>
			<span class="token comment">// Can be a filter, a input ID or an inline expression</span>
			<span class="token string">&quot;from&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;files&quot;</span><span class="token punctuation">,</span>
			<span class="token comment">// Can be a filter or inline expression</span>
			<span class="token string">&quot;when&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;${originalMessage}.match(/root/)&quot;</span><span class="token punctuation">,</span>
			<span class="token comment">// Disable flow (false by default)</span>
			<span class="token string">&quot;disabled&quot;</span> <span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
			<span class="token comment">// Processors</span>
			<span class="token string">&quot;processors&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;$groupAndFilter&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token comment">// Transporters</span>
			<span class="token string">&quot;transporters&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;logger&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;$fileAndMongo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token comment">// Transporters mode</span>
			<span class="token string">&quot;mode&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;parallel&quot;</span><span class="token punctuation">,</span>
			<span class="token comment">// Forked or in main process (main process by default)</span>
			<span class="token string">&quot;forked&quot;</span> <span class="token punctuation">:</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="configuration"><a href="#configuration" aria-hidden="true" class="header-anchor">#</a> Configuration</h2> <p>Flows are declared in the JSON configuration file, following this syntax:</p> <ul><li><strong>id</strong> : ID is optional since every flow without one will receive an automatic identifier. But can be useful in case you need to keep track of the flow work.</li> <li><strong>from</strong>: Can be a filter ID, a filter group (preceded by a $), an input ID, or an inline expression. This field describes which entries will be sent to this flow. There are two special filters that can be used:
<ul><li>* : When * is used, a flow will accept all entries.</li> <li>DEFAULT : Tis a special case where a flow will receive entries that haven't been sent to any other flow.</li></ul></li> <li><strong>when</strong> : Can be a filter ID, a filter group (preceded by a $), or an inline expression. <strong>when</strong> is meant to be a second filter, useful when nesting flows (see below for nested flows)</li> <li><strong>disabled</strong> : Optional. Can <em>true</em> or <em>false</em> (<em>false</em> by default). This disables a flow (useful for test and debugging purpose).</li> <li><strong>processors</strong> : A list of processor / processor group IDs (preceded by $). This is the list of processor instances that will transform the entries. They are chained in the same order they are declared.</li> <li><strong>transporters</strong> : A list of transporter / transporter group IDs (preceded by $). This is the list of transporter instances that will send the entries to their destinatios. They are chained in the same order they are declared.</li> <li><strong>mode</strong> : Optional. Can be either <em>serial</em> or <em>parallel</em> (<em>serial</em> by default). If there are more than one transporter referenced in the <em>transporters</em> section (note that a transporter group is seen as a single transporter by the flow), this field (as seen in the <a href="/transporters/">transporters section</a>) indicates whether transporters are run in serial or parallel mode.</li> <li><strong>forked</strong> : Optional. Can be <em>true</em> or <em>false</em>. When a flow is forked, NSyslog spawns a new process where the flow will be executed. This is useful on multicore CPUs, so we can release som workload from the main process and send it to this child process. This way you can take advantage of multicore CPUs. Take in mind, however, these considerations:
<ul><li>Inputs are still executed in the main process, so entries must be sent to the child processes via IPC mechanisms. This implies that serialization/deserialization of entries can surpass the benefits of forking the flow.</li> <li>If you plan to reference a processor / transporter in multiple flows (so they can <em>correlate</em> entries in some way; collecting stats, execute bussiness rules, etc..) note that a forked process doesn't share any state from its parent process, so, a different process means different processor / transporter instances, that <strong>shares nothing</strong> whith their parent ones.</li></ul></li></ul> <h2 id="nested-flows-flow-inheritance"><a href="#nested-flows-flow-inheritance" aria-hidden="true" class="header-anchor">#</a> Nested flows (flow inheritance)</h2> <p>Nested flows are a way to avoid writing multiple flows in the configuration file that shares many things in common. This way, you write a hierarchical flow tree where children processes inherits the properties of their parent:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;flows&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;transporters&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mode&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;parallel&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;flows&quot;</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span><span class="token string">&quot;when&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;httpOk&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;transporters&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span><span class="token string">&quot;when&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;httpRed&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;transporters&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;warn&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span><span class="token string">&quot;when&quot;</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">&quot;httpErr&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&quot;transporters&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p><a href="/" class="router-link-active">Back</a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dc7d723d.js" defer></script><script src="/assets/js/2.ee805e80.js" defer></script><script src="/assets/js/10.82981d72.js" defer></script>
  </body>
</html>
